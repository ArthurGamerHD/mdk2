<?xml version="1.0" encoding="utf-8"?>
<Project>
    <PropertyGroup>
        <MdkMinifier>none</MdkMinifier>
        <MdkTrim>off</MdkTrim>
        <MdkInteractive>on</MdkInteractive>
        <MdkOutput>auto</MdkOutput>
        <MdkBuildConfiguration>all</MdkBuildConfiguration>
        <MdkArguments />
    </PropertyGroup>

    <Target Name="MdkPackPrepare">
        <PropertyGroup>
            <MdkArgumentsList>pack-script &quot;$(MSBuildProjectFullPath)&quot; -minifier $(MdkMinifier) -output &quot;$(MdkOutput)&quot;</MdkArgumentsList>
        </PropertyGroup>

        <PropertyGroup Condition="'$(MdkTrim)' == 'on'">
            <MdkArgumentsList>$(MdkArgumentsList) -trim</MdkArgumentsList>
        </PropertyGroup>

        <PropertyGroup Condition="'$(MdkInteractive)' == 'on'">
            <MdkArgumentsList>$(MdkArgumentsList) -interactive</MdkArgumentsList>
        </PropertyGroup>
        
        <PropertyGroup>
            <MdkArgumentsList>$(MdkArgumentsList) $(MdkArguments)</MdkArgumentsList>
        </PropertyGroup>
    </Target>
    
    <Target Name="MdkPack" DependsOnTargets="MdkPackPrepare" AfterTargets="Build" Condition="'$(Configuration)' == '$(MdkBuildConfiguration)' Or '$(MdkBuildConfiguration)' == 'all'">
        <Exec Command="&quot;$(MSBuildThisFileDirectory)..\tools\mdk.exe&quot; $(MdkArgumentsList)" />
    </Target>
    
    <Target Name="MdkDidNotPack" DependsOnTargets="MdkPackPrepare" AfterTargets="Build" Condition="'$(Configuration)' != '$(MdkBuildConfiguration)' And '$(MdkBuildConfiguration)' != 'all'">
        <Exec Command="echo MDK did not pack, because the current configuration is '$(Configuration)', not '$(MdkBuildConfiguration)'." />
    </Target>   

</Project>